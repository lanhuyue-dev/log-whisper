# 快速开始

<cite>
**本文档中引用的文件**  
- [README.md](file://README.md)
- [package.json](file://package.json)
- [Cargo.toml](file://Cargo.toml)
- [tauri.conf.json](file://src-tauri/tauri.conf.json)
- [dev.bat](file://scripts/dev.bat)
- [build.sh](file://scripts/build.sh)
- [release.sh](file://scripts/release.sh)
- [main.js](file://src/main.js)
- [main.rs](file://src-tauri/src/main.rs)
- [lib.rs](file://src-tauri/src/lib.rs)
- [commands.rs](file://src-tauri/src/tauri/commands.rs)
- [index.html](file://src/index.html)
</cite>

## 目录
1. [简介](#简介)
2. [开发环境准备](#开发环境准备)
3. [构建与运行](#构建与运行)
4. [配置应用参数](#配置应用参数)
5. [前后端调试方法](#前后端调试方法)
6. [常见问题与解决方案](#常见问题与解决方案)
7. [总结](#总结)

## 简介

LogWhisper 是一款基于 Rust 和 Tauri 构建的轻量级桌面日志分析工具，专为开发者设计，支持本地优先、隐私安全、智能解析 MyBatis SQL 和 JSON 等格式。本指南旨在帮助新手开发者快速搭建本地开发环境，顺利运行并调试 LogWhisper 项目。

通过本指南，您将学会如何安装必要的依赖、启动开发模式、打包发布版本、配置基本参数，并掌握前后端调试技巧，最终能够独立进行功能开发和问题排查。

**Section sources**
- [README.md](file://README.md#L1-L194)

## 开发环境准备

要成功运行 LogWhisper，您需要在本地安装以下核心依赖：

### 1. Rust 工具链
Rust 是后端逻辑的核心语言。请确保安装 Rust 1.70 或更高版本。

安装命令：
```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

验证安装：
```bash
rustc --version
cargo --version
```

### 2. Node.js
Node.js 用于前端构建和 Tauri CLI 的运行。建议安装 Node.js 16 或更高版本。

下载地址：[https://nodejs.org](https://nodejs.org)

验证安装：
```bash
node --version
npm --version
```

### 3. Tauri CLI
Tauri 是连接前端与 Rust 后端的桥梁。通过 npm 安装 Tauri CLI：

```bash
npm install -g @tauri-apps/cli
```

或使用 Cargo 安装：
```bash
cargo install tauri-cli
```

验证安装：
```bash
tauri --version
```

### 4. 项目依赖安装
克隆项目后，进入根目录并安装依赖：

```bash
git clone https://github.com/log-whisper/log-whisper.git
cd log-whisper
npm install
```

该命令会自动安装 `@tauri-apps/api` 和 `@tauri-apps/cli` 等必要包。

**Section sources**
- [README.md](file://README.md#L100-L118)
- [package.json](file://package.json#L1-L28)
- [Cargo.toml](file://Cargo.toml#L1-L15)

## 构建与运行

LogWhisper 提供了多种脚本用于不同场景下的构建与运行。

### 开发模式启动

#### Windows
使用 `dev.bat` 脚本一键启动开发环境：
```cmd
scripts\dev.bat
```

该脚本会自动检查 Rust 和 Tauri CLI 是否安装，若未安装则自动安装，并执行 `cargo tauri dev` 启动应用。

#### Linux/macOS
使用 `build.sh` 脚本构建并运行：
```bash
chmod +x scripts/build.sh
./scripts/build.sh
```

此脚本包含清理、测试和构建流程，确保代码质量。

### 生产环境打包

使用 `release.sh` 脚本生成发布版本：
```bash
./scripts/release.sh
```

该脚本将执行以下操作：
- 读取 `Cargo.toml` 中的版本号
- 运行测试脚本 `test.sh`
- 使用 `cargo tauri build` 构建 Windows 平台的 MSI 和 EXE 安装包
- 生成发布目录 `releases/v{version}` 并包含 `CHANGELOG.md`

构建完成后，可在 `releases/` 目录下找到安装包。

**Section sources**
- [dev.bat](file://scripts/dev.bat#L1-L28)
- [build.sh](file://scripts/build.sh#L1-L35)
- [release.sh](file://scripts/release.sh#L1-L80)

## 配置应用参数

主要配置文件为 `src-tauri/tauri.conf.json`，可用于修改应用的基本行为。

### 常见配置项

| 配置项 | 说明 | 示例值 |
|--------|------|--------|
| `productName` | 应用名称 | `"LogWhisper"` |
| `version` | 当前版本号 | `"1.0.0"` |
| `identifier` | 包标识符 | `"com.logwhisper.app"` |
| `app.windows.width` | 主窗口宽度 | `1200` |
| `app.windows.height` | 主窗口高度 | `800` |
| `build.frontendDist` | 前端资源路径 | `"../src"` |

### 修改示例

如需修改应用名称和窗口尺寸，可编辑 `tauri.conf.json`：
```json
{
  "productName": "我的日志分析器",
  "app": {
    "windows": [
      {
        "title": "我的日志分析器",
        "width": 1400,
        "height": 900
      }
    ]
  }
}
```

保存后重新运行 `cargo tauri dev` 即可生效。

**Section sources**
- [tauri.conf.json](file://src-tauri/tauri.conf.json#L1-L22)

## 前后端调试方法

### 前端调试

前端代码位于 `src/` 目录，使用标准 HTML/CSS/JS 技术栈。

1. **使用浏览器开发者工具**
   - 启动开发模式后，右键点击页面选择“检查”
   - 在 Console 面板查看日志输出
   - 在 Sources 面板设置断点调试 `main.js`

2. **启用调试面板**
   - 点击底部状态栏的“🐛 调试”按钮
   - 查看实时日志、性能统计和内存使用情况

3. **日志输出**
   前端通过 `this.info()`、`this.debug()`、`this.error()` 方法输出日志，内容会显示在调试面板中。

### 后端调试

后端使用 Rust 编写，位于 `src-tauri/src/` 目录。

1. **使用 `println!` 输出**
   在 `main.rs` 或 `lib.rs` 中添加打印语句：
   ```rust
   println!("当前文件路径: {}", file_path);
   ```

2. **使用日志库 `env_logger`**
   项目已集成 `env_logger`，可通过 `info!`、`debug!`、`error!` 宏输出结构化日志：
   ```rust
   info!("应用启动中...");
   debug!("解析请求: {:?}", request);
   error!("文件解析失败: {}", e);
   ```

   日志默认输出到控制台，并写入 `logs/logwhisper_YYYY-MM-DD.log` 文件。

3. **查看 Tauri 日志**
   运行 `cargo tauri dev` 时，所有后端日志将实时输出到终端，便于追踪执行流程。

**Section sources**
- [main.js](file://src/main.js#L1-L799)
- [lib.rs](file://src-tauri/src/lib.rs#L1-L72)
- [commands.rs](file://src-tauri/src/tauri/commands.rs#L1-L293)

## 常见问题与解决方案

### 1. 权限错误（Windows）
**问题**：运行 `dev.bat` 时提示权限不足。  
**解决方案**：以管理员身份运行命令提示符或 PowerShell。

### 2. 依赖缺失
**问题**：`cargo tauri dev` 报错找不到 `tauri-cli`。  
**解决方案**：手动安装 Tauri CLI：
```bash
cargo install tauri-cli
```

### 3. 构建失败
**问题**：`cargo tauri build` 编译错误。  
**解决方案**：
- 确保 Rust 版本 ≥ 1.70
- 执行 `cargo clean` 清理缓存后重试
- 检查 `Cargo.toml` 依赖是否完整

### 4. 前端资源未加载
**问题**：页面空白，提示无法加载资源。  
**解决方案**：确认 `tauri.conf.json` 中 `frontendDist` 指向正确的路径（`"../src"`）。

### 5. 文件拖拽无效
**问题**：拖拽日志文件无反应。  
**解决方案**：检查 `index.html` 中事件监听是否正常绑定，确保 `setupDragAndDrop()` 被调用。

### 6. 日志解析失败
**问题**：大文件（>50MB）无法解析。  
**解决方案**：项目限制最大文件大小为 50MB，可在 `main.js` 中调整校验逻辑或启用分块加载。

**Section sources**
- [dev.bat](file://scripts/dev.bat#L1-L28)
- [lib.rs](file://src-tauri/src/lib.rs#L1-L72)
- [main.js](file://src/main.js#L1-L799)
- [index.html](file://src/index.html#L1-L248)

## 总结

本指南详细介绍了 LogWhisper 的本地开发全流程，涵盖环境搭建、构建运行、配置修改、调试技巧及常见问题处理。通过合理利用提供的脚本和配置文件，开发者可以快速进入开发状态。

建议新手从 `dev.bat` 或 `cargo tauri dev` 开始，熟悉前后端交互机制，并善用调试面板和日志系统进行问题排查。随着对项目结构的深入理解，可进一步扩展插件功能或优化解析性能。

**Section sources**
- [README.md](file://README.md#L1-L194)
- [dev.bat](file://scripts/dev.bat#L1-L28)
- [release.sh](file://scripts/release.sh#L1-L80)