# 日志行样式

<cite>
**Referenced Files in This Document **   
- [style.css](file://src/style.css)
- [main.js](file://src/main.js)
</cite>

## 目录
1. [日志行基础样式](#日志行基础样式)
2. [悬停效果与视觉反馈](#悬停效果与视觉反馈)
3. [日志级别视觉区分](#日志级别视觉区分)
4. [CSS变量与主题适配](#css变量与主题适配)
5. [虚拟滚动性能优化](#虚拟滚动性能优化)
6. [JavaScript动态样式机制](#javascript动态样式机制)

## 日志行基础样式

`.log-line` 类是日志行的核心样式，定义了日志条目的基本外观和布局。该样式通过简洁的内边距、左侧边框和过渡动画，为用户提供清晰且流畅的视觉体验。

**设计细节**：
- **内边距**：设置为 `padding: 4px 8px`，在保证可读性的同时避免过度拥挤
- **左侧边框**：使用 `border-left: 3px solid transparent` 创建一个3像素宽的左侧边框，作为日志级别的视觉标识区
- **边距**：`margin-bottom: 1px` 确保日志行之间有细微分隔，增强可读性
- **背景色**：初始背景为透明 `background-color: transparent`
- **过渡动画**：`transition: all 0.2s ease` 为所有属性变化提供平滑的0.2秒缓动过渡

**Section sources**
- [style.css](file://src/style.css#L110-L114)

## 悬停效果与视觉反馈

悬停效果通过 `:hover` 伪类实现，为用户提供交互反馈。当用户将鼠标悬停在日志行上时，会触发背景色变化，突出显示当前选中的日志条目。

**实现机制**：
- **背景色变化**：`background-color: var(--bg-hover)` 将背景色更改为预定义的悬停状态颜色
- **过渡效果**：继承基础样式的0.2秒缓动过渡，确保颜色变化平滑自然

这种设计不仅提升了用户体验，还帮助用户在大量日志中快速定位和跟踪特定条目。

**Section sources**
- [style.css](file://src/style.css#L115-L117)

## 日志级别视觉区分

日志级别通过为 `.log-line` 元素添加特定的级别类名（如 `.error`、`.warning`）来实现视觉区分。每个级别都有独特的左侧边框颜色和背景色，使用户能够快速识别日志的重要程度。

### 错误级别 (error)
- **左侧边框颜色**：`var(--color-error)`（亮色主题下为 `#ef4444`）
- **背景色**：`var(--block-error-bg)`（亮色主题下为浅红色渐变）

### 警告级别 (warning)
- **左侧边框颜色**：`var(--color-warning)`（亮色主题下为 `#f59e0b`）
- **背景色**：`var(--block-warning-bg)`（亮色主题下为浅橙色渐变）

### 信息级别 (info)
- **左侧边框颜色**：`var(--color-info)`（亮色主题下为 `#3b82f6`）
- **背景色**：`var(--block-info-bg)`（亮色主题下为浅蓝色渐变）

### 调试级别 (debug)
- **左侧边框颜色**：`var(--text-tertiary)`（亮色主题下为 `#9ca3af`）
- **背景色**：`var(--bg-tertiary)`（亮色主题下为 `#f1f5f9`）

**Section sources**
- [style.css](file://src/style.css#L119-L134)

## CSS变量与主题适配

日志行样式通过CSS变量实现了完整的主题适配能力。系统定义了两套主题变量（亮色和暗色），并通过 `data-theme` 属性切换。

### CSS变量定义
系统在 `:root` 选择器中定义了基础颜色、背景色、文本色和边框色等变量。当应用 `data-theme="dark"` 属性时，这些变量会被暗色主题的值覆盖。

### 主题切换机制
- **默认主题**：未设置 `data-theme` 时使用亮色主题
- **暗色主题**：通过 `data-theme="dark"` 激活
- **系统偏好**：支持 `prefers-color-scheme` 媒体查询，自动匹配系统主题偏好

这种基于CSS变量的设计使得主题切换无需重新加载页面，只需更改一个属性即可全局更新所有相关样式。

**Section sources**
- [style.css](file://src/style.css#L1-L108)

## 虚拟滚动性能优化

对于大型日志文件，系统采用虚拟滚动技术优化性能。虚拟滚动通过只渲染可见区域的日志行来显著减少DOM元素数量，从而提升滚动流畅度和内存使用效率。

### 性能优化策略
- **减少重绘**：仅当滚动位置变化导致可见区域改变时才重新渲染
- **硬件加速**：使用 `transform: translateY()` 移动可见容器，利用GPU加速
- **分块加载**：大文件被分割成块，按需加载，避免一次性解析整个文件
- **内存清理**：定期清理远离可见区域的数据，释放内存

### 虚拟滚动实现
- **容器结构**：创建三层结构 - 外层滚动容器、占位容器和绝对定位的可见容器
- **高度计算**：占位容器的高度为 `总条目数 × 单条高度`，保持滚动条比例正确
- **位置更新**：可见容器通过 `transform: translateY()` 定位到正确位置

**Section sources**
- [main.js](file://src/main.js#L1386-L1404)
- [main.js](file://src/main.js#L1510-L1543)
- [main.js](file://src/main.js#L1801-L1851)

## JavaScript动态样式机制

日志行的样式变化由JavaScript逻辑驱动，通过动态添加级别类名来触发CSS样式变化。

### 样式类名生成
`getLogLevelClass` 方法根据日志级别返回对应的CSS类名：
```javascript
getLogLevelClass(level) {
    const classes = {
        'Error': 'error',
        'Warn': 'warning',
        'Info': 'info',
        'Debug': 'debug'
    };
    return classes[level] || 'debug';
}
```

### 动态样式应用
在渲染日志时，系统调用 `renderOriginalLog` 方法，为每个日志行动态添加相应的级别类名：
```javascript
div.className = `log-line ${this.getLogLevelClass(entry.original.level)} fade-in`;
```

### 虚拟滚动中的样式应用
在虚拟滚动模式下，`renderVirtualLogItem` 方法负责为可见的日志行应用样式，确保只有渲染的条目才消耗样式计算资源。

这种机制实现了样式与数据的分离，使得样式变化完全由CSS控制，而JavaScript仅负责数据到类名的映射，提高了代码的可维护性和性能。

**Section sources**
- [main.js](file://src/main.js#L945-L953)
- [main.js](file://src/main.js#L842-L865)
- [main.js](file://src/main.js#L1878-L1921)