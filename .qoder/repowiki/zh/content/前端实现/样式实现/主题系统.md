# ä¸»é¢˜ç³»ç»Ÿ

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**  
- [style.css](file://src/style.css)
- [main.js](file://src/main.js)
- [index.html](file://src/index.html)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
3. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
4. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
5. [è¯¦ç»†ç»„ä»¶åˆ†æ](#è¯¦ç»†ç»„ä»¶åˆ†æ)
6. [ä¾èµ–åˆ†æ](#ä¾èµ–åˆ†æ)
7. [æ€§èƒ½è€ƒè™‘](#æ€§èƒ½è€ƒè™‘)
8. [æ•…éšœæ’é™¤æŒ‡å—](#æ•…éšœæ’é™¤æŒ‡å—)
9. [ç»“è®º](#ç»“è®º)

## ç®€ä»‹
LogWhisper æ˜¯ä¸€æ¬¾ç”¨äºè§£æå’Œå¯è§†åŒ–æ—¥å¿—æ–‡ä»¶çš„å‰ç«¯åº”ç”¨ï¼Œæ”¯æŒäº®è‰²ä¸æš—è‰²ä¸»é¢˜åˆ‡æ¢ã€‚æœ¬ç³»ç»Ÿé€šè¿‡ CSS å˜é‡å®ç°ä¸»é¢˜ç®¡ç†ï¼Œç»“åˆ JavaScript åŠ¨æ€æ§åˆ¶ `data-theme` å±æ€§ï¼Œå®ç°å³æ—¶ä¸»é¢˜åˆ‡æ¢ã€‚ä¸»é¢˜ç³»ç»Ÿä¸ä»…æ¶µç›–åŸºç¡€é¢œè‰²ã€èƒŒæ™¯ã€æ–‡æœ¬ã€è¾¹æ¡†å’Œé˜´å½±ï¼Œè¿˜æ‰©å±•è‡³æ—¥å¿—å—æ¸²æŸ“ã€æ»šåŠ¨æ¡æ ·å¼ã€åŠ¨ç”»æ•ˆæœç­‰ï¼Œç¡®ä¿æ•´ä½“è§†è§‰ä¸€è‡´æ€§ã€‚æ­¤å¤–ï¼Œç³»ç»Ÿæ”¯æŒå“åº”å¼è®¾è®¡ä¸æœ¬åœ°å­˜å‚¨è®°å¿†åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

## é¡¹ç›®ç»“æ„
LogWhisper çš„é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œåˆ†ä¸ºå‰ç«¯èµ„æºã€Tauri åç«¯é€»è¾‘ä¸é…ç½®æ–‡ä»¶ä¸‰å¤§æ¨¡å—ã€‚å‰ç«¯éƒ¨åˆ†ä½äº `src/` ç›®å½•ï¼ŒåŒ…å« HTMLã€CSS å’Œ JavaScript æ–‡ä»¶ï¼›åç«¯é€»è¾‘åŸºäº Rust ç¼–å†™ï¼Œä½äº `src-tauri/` ç›®å½•ï¼›æ„å»ºä¸æµ‹è¯•è„šæœ¬é›†ä¸­äº `scripts/` ç›®å½•ã€‚

```mermaid
graph TB
subgraph "å‰ç«¯"
A[index.html] --> B[main.js]
A --> C[style.css]
end
subgraph "åç«¯"
D[src-tauri] --> E[Rust æ¨¡å—]
D --> F[tauri.conf.json]
end
subgraph "å·¥å…·"
G[scripts] --> H[æ„å»º/æµ‹è¯•è„šæœ¬]
end
B --> D
G --> D
```

**Diagram sources**
- [index.html](file://src/index.html#L1-L248)
- [main.js](file://src/main.js#L1-L2094)
- [style.css](file://src/style.css#L1-L519)

**Section sources**
- [index.html](file://src/index.html#L1-L248)
- [main.js](file://src/main.js#L1-L2094)
- [style.css](file://src/style.css#L1-L519)

## æ ¸å¿ƒç»„ä»¶
ä¸»é¢˜ç³»ç»Ÿç”±ä¸‰å¤§æ ¸å¿ƒç»„ä»¶æ„æˆï¼šCSS å˜é‡å®šä¹‰ã€JavaScript ä¸»é¢˜åˆ‡æ¢é€»è¾‘ã€HTML ç»“æ„ç»‘å®šã€‚`:root` å’Œ `[data-theme='dark']` å®šä¹‰äº†äº®è‰²ä¸æš—è‰²ä¸»é¢˜çš„é¢œè‰²å˜é‡ï¼›`main.js` ä¸­çš„ `initTheme()`ã€`toggleTheme()` å’Œ `applyTheme()` æ–¹æ³•è´Ÿè´£åˆå§‹åŒ–ä¸åˆ‡æ¢ä¸»é¢˜ï¼›`index.html` ä¸­çš„ `<body>` å…ƒç´ é€šè¿‡ `data-theme` å±æ€§ç»‘å®šä¸»é¢˜çŠ¶æ€ã€‚

**Section sources**
- [style.css](file://src/style.css#L4-L210)
- [main.js](file://src/main.js#L1160-L1202)
- [index.html](file://src/index.html#L1-L248)

## æ¶æ„æ¦‚è§ˆ
ä¸»é¢˜ç³»ç»Ÿçš„æ•´ä½“æ¶æ„åŸºäº CSS è‡ªå®šä¹‰å±æ€§ï¼ˆCSS Variablesï¼‰ä¸ DOM å±æ€§æ§åˆ¶ç›¸ç»“åˆçš„æ–¹å¼ã€‚CSS å±‚é¢é€šè¿‡ `:root` å®šä¹‰é»˜è®¤äº®è‰²ä¸»é¢˜ï¼Œé€šè¿‡ `[data-theme='dark']` è¦†ç›–å˜é‡å€¼å®ç°æš—è‰²ä¸»é¢˜ã€‚JavaScript å±‚é¢é€šè¿‡ç›‘å¬æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼Œè°ƒç”¨ `toggleTheme()` æ–¹æ³•ä¿®æ”¹ `body` å…ƒç´ çš„ `data-theme` å±æ€§ï¼Œè§¦å‘ CSS é‡æ–°è®¡ç®—ï¼Œå®ç°æ— åˆ·æ–°ä¸»é¢˜åˆ‡æ¢ã€‚ç”¨æˆ·åå¥½é€šè¿‡ `localStorage` æŒä¹…åŒ–ï¼Œç³»ç»Ÿé»˜è®¤ä¸»é¢˜é€šè¿‡ `prefers-color-scheme` åª’ä½“æŸ¥è¯¢è‡ªåŠ¨é€‚é…ã€‚

```mermaid
graph LR
A[ç”¨æˆ·ç‚¹å‡»åˆ‡æ¢æŒ‰é’®] --> B[JavaScript: toggleTheme()]
B --> C[æ›´æ–° currentTheme çŠ¶æ€]
C --> D[è°ƒç”¨ applyTheme()]
D --> E[è®¾ç½® body[data-theme]]
E --> F[CSS å˜é‡é‡æ–°è®¡ç®—]
F --> G[é¡µé¢æ ·å¼å³æ—¶æ›´æ–°]
H[é¡µé¢åŠ è½½] --> I[initTheme()]
I --> J[è¯»å– localStorage æˆ–ç³»ç»Ÿåå¥½]
J --> C
```

**Diagram sources**
- [main.js](file://src/main.js#L1160-L1202)
- [style.css](file://src/style.css#L4-L210)

## è¯¦ç»†ç»„ä»¶åˆ†æ

### ä¸»é¢˜å˜é‡å®šä¹‰åˆ†æ
CSS å˜é‡åœ¨ `:root` å’Œ `[data-theme='dark']` ä¸­ç³»ç»Ÿæ€§åœ°ç»„ç»‡ä¸ºå¤šä¸ªç±»åˆ«ï¼šåŸºç¡€è‰²ã€èƒŒæ™¯è‰²ã€æ–‡æœ¬è‰²ã€è¾¹æ¡†è‰²ã€é˜´å½±ã€æ¸²æŸ“å—èƒŒæ™¯ç­‰ã€‚æ¯ä¸ªå˜é‡å‘½åæ¸…æ™°ï¼Œè¯­ä¹‰æ˜ç¡®ï¼Œä¾¿äºç»´æŠ¤ä¸æ‰©å±•ã€‚

#### äº®è‰²ä¸æš—è‰²ä¸»é¢˜é¢œè‰²æ˜ å°„
ä»¥ä¸‹è¡¨æ ¼å±•ç¤ºäº†ä¸»è¦é¢œè‰²å˜é‡åœ¨ä¸¤ç§ä¸»é¢˜ä¸‹çš„æ˜ å°„å…³ç³»ï¼š

| å˜é‡å | äº®è‰²ä¸»é¢˜å€¼ | æš—è‰²ä¸»é¢˜å€¼ | ç”¨é€” |
|--------|------------|------------|------|
| `--bg-primary` | `#ffffff` | `#0f172a` | é¡µé¢ä¸»èƒŒæ™¯ |
| `--text-primary` | `#1f2937` | `#f8fafc` | ä¸»è¦æ–‡æœ¬é¢œè‰² |
| `--border-primary` | `#e5e7eb` | `#334155` | ä¸»è¦è¾¹æ¡†é¢œè‰² |
| `--shadow-md` | `0 4px 6px -1px rgba(0,0,0,0.1)` | `0 4px 6px -1px rgba(0,0,0,0.4)` | ä¸­ç­‰é˜´å½± |
| `--color-primary` | `#1e3a8a` | `#3b82f6` | ä¸»è‰²è°ƒï¼ˆæŒ‰é’®ã€é“¾æ¥ï¼‰ |

**Section sources**
- [style.css](file://src/style.css#L4-L210)

### ä¸»é¢˜åˆ‡æ¢æœºåˆ¶åˆ†æ
ä¸»é¢˜åˆ‡æ¢ç”± JavaScript æ§åˆ¶ï¼Œæ ¸å¿ƒæ–¹æ³•åŒ…æ‹¬ï¼š

#### initTheme æ–¹æ³•
åˆå§‹åŒ–ä¸»é¢˜ï¼Œä¼˜å…ˆè¯»å– `localStorage` ä¸­ä¿å­˜çš„ç”¨æˆ·é€‰æ‹©ï¼Œè‹¥æ— åˆ™æ ¹æ®ç³»ç»Ÿåå¥½è‡ªåŠ¨è®¾ç½®ã€‚

```mermaid
flowchart TD
Start([initTheme]) --> CheckStorage["localStorage.getItem('logwhisper-theme')"]
CheckStorage --> |å­˜åœ¨| SetFromStorage["this.currentTheme = savedTheme"]
CheckStorage --> |ä¸å­˜åœ¨| CheckPrefers["matchMedia('(prefers-color-scheme: dark)')"]
CheckPrefers --> |åŒ¹é…| SetDark["this.currentTheme = 'dark'"]
CheckPrefers --> |ä¸åŒ¹é…| SetLight["this.currentTheme = 'light'"]
SetFromStorage --> Apply
SetDark --> Apply
SetLight --> Apply
Apply --> CallApply["applyTheme()"]
```

**Diagram sources**
- [main.js](file://src/main.js#L1160-L1172)

#### toggleTheme æ–¹æ³•
åˆ‡æ¢ä¸»é¢˜çŠ¶æ€ï¼Œæ›´æ–° `localStorage` å¹¶æ˜¾ç¤ºæç¤ºã€‚

```mermaid
sequenceDiagram
participant User as ç”¨æˆ·
participant Button as ä¸»é¢˜æŒ‰é’®
participant JS as JavaScript
participant DOM as DOM
participant Storage as localStorage
participant Toast as æç¤ºæ¡†
User->>Button : ç‚¹å‡»
Button->>JS : è§¦å‘äº‹ä»¶
JS->>JS : åˆ‡æ¢ currentTheme
JS->>DOM : è°ƒç”¨ applyTheme()
JS->>Storage : ä¿å­˜æ–°ä¸»é¢˜
JS->>Toast : æ˜¾ç¤ºåˆ‡æ¢æç¤º
```

**Diagram sources**
- [main.js](file://src/main.js#L1174-L1189)

#### applyTheme æ–¹æ³•
å°†å½“å‰ä¸»é¢˜åº”ç”¨åˆ° DOMï¼Œé€šè¿‡è®¾ç½® `body` çš„ `data-theme` å±æ€§å’Œæ›´æ–°å›¾æ ‡ã€‚

```mermaid
flowchart TD
A[applyTheme] --> B{currentTheme === 'dark'?}
B --> |æ˜¯| C[body.setAttribute('data-theme', 'dark')]
B --> |å¦| D[body.setAttribute('data-theme', 'light')]
C --> E[themeIcon.textContent = 'â˜€ï¸']
D --> F[themeIcon.textContent = 'ğŸŒ™']
```

**Diagram sources**
- [main.js](file://src/main.js#L1191-L1202)

## ä¾èµ–åˆ†æ
ä¸»é¢˜ç³»ç»Ÿä¾èµ–äºç°ä»£æµè§ˆå™¨å¯¹ CSS è‡ªå®šä¹‰å±æ€§å’Œ `prefers-color-scheme` åª’ä½“æŸ¥è¯¢çš„æ”¯æŒã€‚JavaScript éƒ¨åˆ†ä¾èµ– DOM API è¿›è¡Œå±æ€§æ“ä½œä¸äº‹ä»¶ç›‘å¬ã€‚UI ç»„ä»¶é€šè¿‡ `style` å±æ€§æˆ– CSS ç±»ç»‘å®šå˜é‡ï¼Œå½¢æˆä¾èµ–é“¾ã€‚

```mermaid
graph TD
CSS[CSS Variables] --> HTML[HTML Elements]
JS[JavaScript] --> DOM[DOM API]
DOM --> HTML
Storage[localStorage] --> JS
Media[prefers-color-scheme] --> JS
```

**Diagram sources**
- [style.css](file://src/style.css#L4-L210)
- [main.js](file://src/main.js#L1160-L1202)

## æ€§èƒ½è€ƒè™‘
ä¸»é¢˜åˆ‡æ¢ä¸ºçº¯ CSS å˜é‡æ›´æ–°ï¼Œä¸æ¶‰åŠé‡æ’æˆ–é‡ç»˜çš„å¤§è§„æ¨¡è®¡ç®—ï¼Œæ€§èƒ½å¼€é”€æä½ã€‚è¿‡æ¸¡åŠ¨ç”»é€šè¿‡ `transition` å±æ€§å®ç°ï¼Œä»…å½±å“ `background-color` å’Œ `color`ï¼Œé¿å…æ€§èƒ½ç“¶é¢ˆã€‚`localStorage` è¯»å†™æ“ä½œè½»é‡ï¼Œä¸å½±å“ä¸»çº¿ç¨‹å“åº”ã€‚

**Section sources**
- [style.css](file://src/style.css#L55-L56)
- [main.js](file://src/main.js#L1160-L1202)

## æ•…éšœæ’é™¤æŒ‡å—
### ä¸»é¢˜æœªç”Ÿæ•ˆ
- æ£€æŸ¥ `data-theme` æ˜¯å¦æ­£ç¡®è®¾ç½®åœ¨ `<body>` ä¸Š
- ç¡®è®¤ CSS æ–‡ä»¶å·²æ­£ç¡®åŠ è½½
- éªŒè¯å˜é‡åæ‹¼å†™æ˜¯å¦ä¸€è‡´

### åˆ‡æ¢æ— åŠ¨ç”»
- æ£€æŸ¥ `body` æ˜¯å¦å®šä¹‰äº† `transition` å±æ€§
- ç¡®ä¿ä¿®æ”¹çš„æ˜¯ `data-theme` è€Œéç›´æ¥ä¿®æ”¹æ ·å¼

### ç³»ç»Ÿåå¥½æœªç”Ÿæ•ˆ
- ç¡®è®¤æµè§ˆå™¨æ”¯æŒ `window.matchMedia`
- æ£€æŸ¥åª’ä½“æŸ¥è¯¢è¯­æ³•æ˜¯å¦æ­£ç¡®

**Section sources**
- [style.css](file://src/style.css#L55-L56)
- [main.js](file://src/main.js#L1160-L1172)

## ç»“è®º
LogWhisper çš„ä¸»é¢˜ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„ CSS å˜é‡ä¸ JavaScript æ§åˆ¶ç›¸ç»“åˆçš„æ–¹å¼ï¼Œå®ç°äº†é«˜æ•ˆã€å¯ç»´æŠ¤ã€ç”¨æˆ·ä½“éªŒå‹å¥½çš„äº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢æœºåˆ¶ã€‚ç³»ç»Ÿè®¾è®¡å……åˆ†è€ƒè™‘äº†å¯æ‰©å±•æ€§ä¸æ€§èƒ½ï¼Œä¸ºåç»­æ–°å¢ä¸»é¢˜æˆ–è°ƒæ•´é…è‰²æä¾›äº†è‰¯å¥½åŸºç¡€ã€‚å»ºè®®åœ¨è‡ªå®šä¹‰æ–°ä¸»é¢˜æ—¶ï¼Œéµå¾ªç°æœ‰å˜é‡å‘½åè§„èŒƒï¼Œä¿æŒè§†è§‰ä¸€è‡´æ€§ï¼Œå¹¶é€šè¿‡ `localStorage` è®°ä½ç”¨æˆ·é€‰æ‹©ï¼Œæå‡äº§å“ä½“éªŒã€‚